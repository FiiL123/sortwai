<!doctype html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.iconify.design/iconify-icon/2.2.0/iconify-icon.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>

    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <link rel="stylesheet" href="{% static 'app.css' %}">
    <title>SortWAI</title>
</head>
<body>
    <div class="container">
        <h1 class="brand">Placeholder názov</h1>

        <form action="" class="search">
            {% if item %}
                <input type="search" name="q" value="{{ item.product_name }}" class="search__input">
            {% else %}
                <input type="search" name="q" placeholder="Ako triediť...?" class="search__input">
            {% endif %}
            <button class="search__button" type="submit">
                <iconify-icon icon="mdi:search"></iconify-icon>
                <span class="search__button_text">Vyhľadať</span>
            </button>
            <a href="{% url 'scanner' %}" class="search__button">
                <iconify-icon icon="mdi:barcode-scan"></iconify-icon>
                <span class="search__button_text">Čiarový kód</span>
            </a>
        </form>

        <div class="location_note">
            {% if municipality %}
                Zobrazujeme informácie pre <b id="municipality">{{ municipality }}</b> <a id="change_municipality">(zmeniť)</a>
            {% else %}
                Vašu lokáciu sa nepodarilo nájsť, <a class="link" id="change_municipality">vyberte manuálne.</a>
            {% endif %}
        </div>

        <div class="tabs">
            <a href="{% url "category_list" %}" class="tabs__item {% if request.resolver_match.url_name == 'category_list' %}tabs__item--active{% endif %}">
                Odpad
            </a>
            <a href="{% url "location_list" %}" class="tabs__item {% if request.resolver_match.url_name == 'location_list' %}tabs__item--active{% endif %}">
                Miesta
            </a>
            <a href="{% url "document_list" %}" class="tabs__item {% if request.resolver_match.url_name == 'document_list' %}tabs__item--active{% endif %}">
                Dokumenty
            </a>
        </div>

        {% block body %}{% endblock %}
    </div>

    <a href="#" class="chat_cta">
        <iconify-icon icon="mdi:chat-question" width="none"></iconify-icon>
    </a>

    <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>
            <form method="POST" action="{% url 'change_municipality' %}">
                {% csrf_token %}
                {{ municipality_form }}
                <button type="submit" class="submit">Zmeň</button>
            </form>
        </div>

    </div>
    <script>
        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal
        var btn = document.getElementById("change_municipality");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks on the button, open the modal
        btn.onclick = function() {
            modal.style.display = "block";
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
            modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>
<script src="{% static 'js/location.js' %}"></script>
</body>
</html>
